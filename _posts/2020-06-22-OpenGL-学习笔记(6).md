---
title: OpenGL 学习笔记(6)
tags: OpenGL
mode: immersive
header:
  theme: dark
article_header:
  type: overlay
  theme: dark
  background_color: '#203028'
  background_image:
    gradient: 'linear-gradient(135deg, rgba(34, 139, 87 , .4), rgba(139, 34, 139, .4))'
    src: /docs/assets/images/cover3.jpg
---

# 材质

材质颜色(Material Color)：

- 环境光照(Ambient Lighting)
- 漫反射光照(Diffuse Lighting)
- 镜面光照(Specular Lighting)
- 反光度(Shininess)

材质属性：

```C++
#version 330 core
struct Material {
    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
    float shininess;
}; 

uniform Material material;
```

**Q:材质属性中的四个分量与《基础光照》中的四个分量的区别？**

**A:**这里的材质属性是一组常量，即不管片段以及光照的位置是什么，对于一种材质只有一组材质属性。而上一节《基础光照》中的漫反射光照以及镜面光照，对不同位置的片段，对应不同的值。材质属性是常量，光照分量是变量。

## 设置材质

> 物体的每个材质属性都乘上了它们对应的光照分量。

```c++
// 环境光
vec3 ambient = lightColor * material.ambient;

// 漫反射
vec3 diffuse = lightColor * (diff * material.diffuse);

// 镜面光
float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);
vec3 specular = lightColor * (spec * material.specular);  
```

## 光的属性

Q:为什么设置光的属性？ A:经过上述方法实现的材质，物体过亮。

> 物体过亮的原因是环境光、漫反射和镜面光这三个颜色对任何一个光源都会去全力反射。光源对环境光、漫反射和镜面光分量也具有着不同的强度。	

光照属性：

```C++
struct Light {
    vec3 position;

    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
};

uniform Light light;
```

> 一个光源对它的ambient、diffuse和specular光照有着不同的强度。环境光照通常会设置为一个比较低的强度，因为我们不希望环境光颜色太过显眼。光源的漫反射分量通常设置为光所具有的颜色，通常是一个比较明亮的白色。镜面光分量通常会保持为`vec3(1.0)`，以最大强度发光。

与材质属性相似，光照属性也是一组常量。

**Q:**光照属性和《基础光照》中四个分量的区别？

**A:**光照属性是常量，而《基础光照》中的四个分量则是变量，同材质属性。

更新片段着色器：

```C++
vec3 ambient  = light.ambient * material.ambient;
vec3 diffuse  = light.diffuse * (diff * material.diffuse);
vec3 specular = light.specular * (spec * material.specular);
```

**Q:**这里的光照属性是指光照强度还是光照颜色呢？需不需要与光照颜色相乘？

## 不同的光源颜色

> 我们可以利用sin和glfwGetTime函数改变光源的环境光和漫反射颜色，从而很容易地让光源的颜色随着时间变化

**Q:**为什么没有改变反射光颜色呢？

**A:**因为文中提到“镜面光分量通常会保持为`vec3(1.0)`，以最大强度发光“，所以不需要改变反射光强度。

**Q:**环境光和漫反射光的关系？代码中为什么这样写？

```C++
glm::vec3 diffuseColor = lightColor   * glm::vec3(0.5f); // 降低影响
glm::vec3 ambientColor = diffuseColor * glm::vec3(0.2f); // 很低的影响
```

# 光照贴图

